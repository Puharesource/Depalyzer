namespace Depalyzer.Common.Models.VulnerabilityCheck;

using System.Text.Json.Serialization;

[JsonConverter(typeof(JsonStringEnumConverter))]
public enum VulnerabilitySeverity
{
    [VulnerabilitySeverityColor("silver")]
    Low = 0,

    [VulnerabilitySeverityColor("yellow")]
    Moderate = 1,

    [VulnerabilitySeverityColor("red")]
    High = 2,

    [VulnerabilitySeverityColor("red")]
    Critical = 3,
}

public static class VulnerabilitySeverityExtensions
{
    public static string GetColor(this VulnerabilitySeverity severity)
    {
        var memberInfo = typeof(VulnerabilitySeverity).GetMember(severity.ToString()).First();
        var attribute = (VulnerabilitySeverityColorAttribute)memberInfo.GetCustomAttributes(typeof(VulnerabilitySeverityColorAttribute), false).First();

        return attribute.Color;
    }
}

[AttributeUsage(AttributeTargets.Field)]
public class VulnerabilitySeverityColorAttribute(string color) : Attribute
{
    public string Color => color;
}
